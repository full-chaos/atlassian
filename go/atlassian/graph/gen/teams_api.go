// Code generated by go/tools/generate_team_models/main.go. DO NOT EDIT.
package gen

import (
	"encoding/json"
	"errors"
	"strings"
)

const TeamARIFormatPrefix = "ari:cloud:identity::team/"

func NormalizeTeamID(raw string) string {
	trimmed := strings.TrimSpace(raw)
	if trimmed == "" {
		return trimmed
	}
	if strings.HasPrefix(trimmed, TeamARIFormatPrefix) {
		return trimmed
	}
	return TeamARIFormatPrefix + trimmed
}

const (
	TeamSearchPageInfoHasEndCursor = true
)

const TeamByIdQuery = `query TeamById(
  $teamId: ID!,
  $siteId: String!
) {
  team {
    teamV2(id: $teamId, siteId: $siteId) {
      id
      displayName
      smallAvatarImageUrl
      state
    }
  }
}
`

const TeamSearchV2Query = `query TeamSearchV2(
  $organizationId: ID!,
  $siteId: String!,
  $query: String,
  $first: Int,
  $after: String
) {
  team {
    teamSearchV2(
      organizationId: $organizationId,
      siteId: $siteId,
      filter: { query: $query },
      first: $first,
      after: $after
    ) @optIn(to: "Team-search-v2") {
      pageInfo { hasNextPage endCursor }
      nodes {
        team {
          id
      displayName
      smallAvatarImageUrl
      state
        }
      }
    }
  }
}
`

type TeamNode struct {
	ID                  string  `json:"id"`
	DisplayName         *string `json:"displayName"`
	SmallAvatarImageURL *string `json:"smallAvatarImageUrl"`
	State               *string `json:"state"`
}

type TeamMemberNode struct {
	AccountID   string  `json:"accountId"`
	DisplayName *string `json:"displayName,omitempty"`
	Role        *string `json:"role,omitempty"`
}

type TeamSearchResultNode struct {
	Team *TeamNode `json:"team"`
}

type TeamPageInfo struct {
	HasNextPage bool    `json:"hasNextPage"`
	EndCursor   *string `json:"endCursor,omitempty"`
}

type TeamSearchConnection struct {
	PageInfo TeamPageInfo           `json:"pageInfo"`
	Nodes    []TeamSearchResultNode `json:"nodes"`
}

type TeamByIdData struct {
	Team *struct {
		Team *TeamNode `json:"teamV2"`
	} `json:"team"`
}

type TeamSearchV2Data struct {
	Team *struct {
		Search *TeamSearchConnection `json:"teamSearchV2"`
	} `json:"team"`
}

func DecodeTeam(data map[string]any) (*TeamNode, error) {
	b, err := json.Marshal(data)
	if err != nil {
		return nil, err
	}
	var out TeamByIdData
	if err := json.Unmarshal(b, &out); err != nil {
		return nil, err
	}
	if out.Team == nil {
		return nil, errors.New("missing team")
	}
	if out.Team.Team == nil {
		return nil, errors.New("missing team node")
	}
	return out.Team.Team, nil
}

func DecodeTeamSearchV2(data map[string]any) (*TeamSearchConnection, error) {
	b, err := json.Marshal(data)
	if err != nil {
		return nil, err
	}
	var out TeamSearchV2Data
	if err := json.Unmarshal(b, &out); err != nil {
		return nil, err
	}
	if out.Team == nil {
		return nil, errors.New("missing team")
	}
	if out.Team.Search == nil {
		return nil, errors.New("missing teamSearchV2")
	}
	conn := out.Team.Search
	return conn, nil
}
