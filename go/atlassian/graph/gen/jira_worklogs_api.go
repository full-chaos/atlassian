// Code generated by go/tools/generate_jira_worklog_models/main.go. DO NOT EDIT.
package gen

import (
	"encoding/json"
	"errors"
)

const (
	WorklogsPageInfoHasEndCursor = true
	WorklogsEdgeHasCursor        = true
)

const JiraIssueWorklogsPageQuery = `query JiraIssueWorklogsPage(
  $cloudId: ID!,
  $key: String!,
  $first: Int!,
  $after: String
) {
  issue: issueByKey(key: $key, cloudId: $cloudId) {
    worklogs(first: $first, after: $after) {
      pageInfo { hasNextPage endCursor }
      edges {
        cursor
        node {
          worklogId
          author { accountId name }
          timeSpent { timeInSeconds }
          created
          updated
          startDate
        }
      }
    }
  }
}
`

type WorklogPageInfo struct {
	HasNextPage bool    `json:"hasNextPage"`
	EndCursor   *string `json:"endCursor"`
}

type WorklogUser struct {
	AccountID string `json:"accountId"`
	Name      string `json:"name"`
}

type WorklogEstimate struct {
	TimeInSeconds *int `json:"timeInSeconds"`
}

type JiraWorklogNode struct {
	WorklogID string          `json:"worklogId"`
	Author    *WorklogUser    `json:"author"`
	TimeSpent WorklogEstimate `json:"timeSpent"`
	Created   string          `json:"created"`
	Updated   *string         `json:"updated"`
	StartDate *string         `json:"startDate"`
}

type JiraWorklogEdge struct {
	Cursor *string         `json:"cursor"`
	Node   JiraWorklogNode `json:"node"`
}

type JiraWorklogConnection struct {
	PageInfo WorklogPageInfo   `json:"pageInfo"`
	Edges    []JiraWorklogEdge `json:"edges"`
}

type JiraIssueWorklogsPageData struct {
	Issue *struct {
		Worklogs JiraWorklogConnection `json:"worklogs"`
	} `json:"issue"`
}

func DecodeIssueWorklogsPage(data map[string]any) (*JiraWorklogConnection, error) {
	b, err := json.Marshal(data)
	if err != nil {
		return nil, err
	}
	var out JiraIssueWorklogsPageData
	if err := json.Unmarshal(b, &out); err != nil {
		return nil, err
	}
	if out.Issue == nil {
		return nil, errors.New("missing issue")
	}
	conn := out.Issue.Worklogs
	return &conn, nil
}
